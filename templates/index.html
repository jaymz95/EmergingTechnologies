<!-- Reffernce: https://www.html5canvastutorials.com/labs/html5-canvas-paint-application/ -->
{% extends "bootstrap/base.html" %}

{% block content %}
<!DOCTYPE HTML>
<html>
  <head>
    <style>
      #canvas {
        border: 5px solid black;
        margin: auto;
        padding: 0px 0px 0px 0px;
        width: 310px;
        height: 310px;
        vertical-align: middle;
      }
      #paint {
        margin: auto;
        width: 300px;
        height: 300px;
        vertical-align: middle;
      }
    </style>
  </head>
  <body data-rsssl=1 align="center">

    <h1>Enter Number (0-9):</h1>
    <div id="canvas">
        <div id="paint">
            <canvas id="myCanvas"></canvas>
        </div>
    </div>
  	
    
    <button type="submit" onclick="myFunction()" class="btn btn-primary">Submit</button>
    <a href="#" class="myButton"><span style=" font-weight: 400; font-family: 'Open Sans', Helvetica;	"> Predict </span></a>			
		
    <script>
        var canvas = document.getElementById('myCanvas');
        var ctx = canvas.getContext('2d');
        
        var painting = document.getElementById('paint');
        var paint_style = getComputedStyle(painting);
        canvas.width = parseInt(paint_style.getPropertyValue('width'));
        canvas.height = parseInt(paint_style.getPropertyValue('height'));

        var mouse = {x: 0, y: 0};
        
        canvas.addEventListener('mousemove', function(e) {
        mouse.x = e.pageX - this.offsetLeft;
        mouse.y = e.pageY - this.offsetTop;
        }, false);

        // draw line colour width
        ctx.lineWidth = 3;
        ctx.lineJoin = 'round';
        ctx.lineCap = 'round';
        ctx.strokeStyle = '#000000';
        
        canvas.addEventListener('mousedown', function(e) {
            ctx.beginPath();
            ctx.moveTo(mouse.x, mouse.y);
        
            canvas.addEventListener('mousemove', onPaint, false);
        }, false);
        
        canvas.addEventListener('mouseup', function() {
            canvas.removeEventListener('mousemove', onPaint, false);
        }, false);
        
        var onPaint = function() {
            ctx.lineTo(mouse.x, mouse.y);
            ctx.stroke();
        };


    </script>
    
    <script src="jquery-3.4.1.min.js">
        $(".myButton").click(function(){
	   			var $SCRIPT_ROOT = '{{ request.script_root|tojson|safe }}';
	   			var canvasObj = document.getElementById("myCanvas");
	   			var img = canvasObj.toDataURL();
	   			$.ajax({
	   				type: "POST",
	   				url: $SCRIPT_ROOT + "/predict/",
	   				data: img,
	   				success: function(data){
	   					$('#result').text(' Predicted Output: '+data);
	   				}
	   			});
	   		});
    </script>
  </body>
</html>    
{% endblock %}        